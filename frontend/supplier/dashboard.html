<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Fournisseur - Brandia</title>
  <meta name="description" content="Espace fournisseur Brandia - G√©rez vos produits, commandes et promotions">
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõçÔ∏è</text></svg>">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            brandia: {
              primary: '#6366f1',
              secondary: '#8b5cf6',
              accent: '#ec4899',
              dark: '#0f172a',
              darker: '#020617',
              card: '#1e293b',
              border: '#334155',
              text: '#f8fafc',
              muted: '#94a3b8',
              success: '#10b981',
              warning: '#f59e0b',
              danger: '#ef4444',
            }
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          }
        }
      }
    }
  </script>
  
  <!-- Chart.js pour les graphiques -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Styles critiques inline -->
  <style>
    /* ========== VARIABLES & RESET ========== */
    :root {
      --brandia-primary: #6366f1;
      --brandia-primary-hover: #4f46e5;
      --brandia-secondary: #8b5cf6;
      --brandia-accent: #ec4899;
      --brandia-dark: #0f172a;
      --brandia-darker: #020617;
      --brandia-card: #1e293b;
      --brandia-card-hover: #334155;
      --brandia-border: #334155;
      --brandia-text: #f8fafc;
      --brandia-text-muted: #94a3b8;
      --brandia-success: #10b981;
      --brandia-warning: #f59e0b;
      --brandia-danger: #ef4444;
      --sidebar-width: 280px;
      --sidebar-collapsed: 80px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background-color: var(--brandia-dark);
      color: var(--brandia-text);
      line-height: 1.6;
      min-width: 320px;
    }

    /* ========== LAYOUT ========== */
    .dashboard-layout {
      display: flex;
      min-height: 100vh;
    }

    /* ========== SIDEBAR ========== */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--brandia-darker);
      border-right: 1px solid var(--brandia-border);
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      z-index: 100;
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
    }

    .sidebar.collapsed {
      width: var(--sidebar-collapsed);
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--brandia-border);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
    }

    .sidebar-logo-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      flex-shrink: 0;
    }

    .sidebar-logo-text {
      font-family: 'Outfit', sans-serif;
      font-size: 1.25rem;
      font-weight: 700;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .sidebar.collapsed .sidebar-logo-text,
    .sidebar.collapsed .nav-text,
    .sidebar.collapsed .nav-section-title {
      display: none;
    }

    .sidebar-toggle {
      position: absolute;
      right: -12px;
      top: 80px;
      width: 24px;
      height: 24px;
      background: var(--brandia-primary);
      border: none;
      border-radius: 50%;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.625rem;
      z-index: 101;
    }

    .sidebar-nav {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .nav-section {
      margin-bottom: 1.5rem;
    }

    .nav-section-title {
      padding: 0 1.5rem;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--brandia-text-muted);
      margin-bottom: 0.5rem;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.875rem 1.5rem;
      color: var(--brandia-text-muted);
      text-decoration: none;
      transition: all 0.2s;
      cursor: pointer;
      border: none;
      background: none;
      width: 100%;
      font-size: 0.875rem;
    }

    .nav-item:hover,
    .nav-item.active {
      background: rgba(99, 102, 241, 0.1);
      color: var(--brandia-primary);
      border-right: 3px solid var(--brandia-primary);
    }

    .nav-item i {
      width: 20px;
      text-align: center;
      font-size: 1rem;
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--brandia-border);
    }

    .btn-back {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: var(--brandia-text-muted);
      text-decoration: none;
      font-size: 0.875rem;
      padding: 0.75rem;
      border-radius: 8px;
      transition: all 0.2s;
    }

    .btn-back:hover {
      background: var(--brandia-card);
      color: var(--brandia-text);
    }

    /* ========== MAIN CONTENT ========== */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      transition: margin-left 0.3s;
      display: flex;
      flex-direction: column;
    }

    .sidebar.collapsed ~ .main-content {
      margin-left: var(--sidebar-collapsed);
    }

    /* ========== HEADER ========== */
    .top-header {
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--brandia-border);
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .header-search {
      position: relative;
      max-width: 400px;
      flex: 1;
    }

    .header-search input {
      width: 100%;
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      padding: 0.625rem 1rem 0.625rem 2.5rem;
      color: var(--brandia-text);
      font-size: 0.875rem;
      outline: none;
    }

    .header-search i {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--brandia-text-muted);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .btn-icon {
      width: 40px;
      height: 40px;
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      color: var(--brandia-text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .btn-icon:hover {
      background: var(--brandia-card-hover);
      color: var(--brandia-text);
    }

    .notification-badge {
      position: absolute;
      top: -2px;
      right: -2px;
      width: 18px;
      height: 18px;
      background: var(--brandia-danger);
      color: white;
      border-radius: 50%;
      font-size: 0.625rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      cursor: pointer;
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 0.875rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--brandia-text);
    }

    .user-role {
      font-size: 0.75rem;
      color: var(--brandia-text-muted);
    }

    /* ========== CONTENT AREA ========== */
    .content-area {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    .page-header {
      margin-bottom: 2rem;
    }

    .page-title {
      font-family: 'Outfit', sans-serif;
      font-size: 1.875rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .page-subtitle {
      color: var(--brandia-text-muted);
    }

    /* ========== KPI CARDS ========== */
    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    @media (min-width: 640px) {
      .kpi-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 1024px) {
      .kpi-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    .kpi-card {
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.3s;
    }

    .kpi-card:hover {
      transform: translateY(-2px);
      border-color: var(--brandia-primary);
    }

    .kpi-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .kpi-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }

    .kpi-icon.blue {
      background: rgba(99, 102, 241, 0.1);
      color: var(--brandia-primary);
    }

    .kpi-icon.green {
      background: rgba(16, 185, 129, 0.1);
      color: var(--brandia-success);
    }

    .kpi-icon.orange {
      background: rgba(245, 158, 11, 0.1);
      color: var(--brandia-warning);
    }

    .kpi-icon.purple {
      background: rgba(139, 92, 246, 0.1);
      color: var(--brandia-secondary);
    }

    .kpi-trend {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .kpi-trend.up {
      color: var(--brandia-success);
    }

    .kpi-trend.down {
      color: var(--brandia-danger);
    }

    .kpi-value {
      font-family: 'Outfit', sans-serif;
      font-size: 1.875rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .kpi-label {
      color: var(--brandia-text-muted);
      font-size: 0.875rem;
    }

    /* ========== CHARTS SECTION ========== */
    .charts-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    @media (min-width: 1024px) {
      .charts-grid {
        grid-template-columns: 2fr 1fr;
      }
    }

    .chart-card {
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 12px;
      padding: 1.5rem;
    }

    .chart-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }

    .chart-title {
      font-weight: 600;
      font-size: 1.125rem;
    }

    .chart-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-sm {
      padding: 0.375rem 0.75rem;
      background: var(--brandia-dark);
      border: 1px solid var(--brandia-border);
      border-radius: 6px;
      color: var(--brandia-text-muted);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-sm:hover,
    .btn-sm.active {
      background: var(--brandia-primary);
      border-color: var(--brandia-primary);
      color: white;
    }

    .chart-container {
      position: relative;
      height: 300px;
    }

    /* ========== SECTIONS ========== */
    .section-card {
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 12px;
      margin-bottom: 1.5rem;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid var(--brandia-border);
    }

    .section-title {
      font-weight: 600;
      font-size: 1.125rem;
    }

    .section-actions {
      display: flex;
      gap: 0.75rem;
    }

    .btn-primary {
      background: var(--brandia-primary);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 0.625rem 1rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary:hover {
      background: var(--brandia-primary-hover);
    }

    .btn-secondary {
      background: var(--brandia-dark);
      color: var(--brandia-text);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      padding: 0.625rem 1rem;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-secondary:hover {
      background: var(--brandia-card-hover);
    }

    .section-content {
      padding: 1.5rem;
    }

    /* ========== TABLES ========== */
    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th,
    .data-table td {
      padding: 1rem;
      text-align: left;
      font-size: 0.875rem;
    }

    .data-table th {
      color: var(--brandia-text-muted);
      font-weight: 500;
      border-bottom: 1px solid var(--brandia-border);
    }

    .data-table td {
      border-bottom: 1px solid var(--brandia-border);
    }

    .data-table tr:last-child td {
      border-bottom: none;
    }

    .product-cell {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .product-thumb {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      object-fit: cover;
      background: var(--brandia-dark);
    }

    .product-info {
      display: flex;
      flex-direction: column;
    }

    .product-name {
      font-weight: 500;
      color: var(--brandia-text);
    }

    .product-sku {
      font-size: 0.75rem;
      color: var(--brandia-text-muted);
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .status-badge.active {
      background: rgba(16, 185, 129, 0.1);
      color: var(--brandia-success);
    }

    .status-badge.pending {
      background: rgba(245, 158, 11, 0.1);
      color: var(--brandia-warning);
    }

    .status-badge.inactive {
      background: rgba(239, 68, 68, 0.1);
      color: var(--brandia-danger);
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-table {
      width: 32px;
      height: 32px;
      background: var(--brandia-dark);
      border: 1px solid var(--brandia-border);
      border-radius: 6px;
      color: var(--brandia-text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-table:hover {
      background: var(--brandia-primary);
      border-color: var(--brandia-primary);
      color: white;
    }

    /* ========== MODALS ========== */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 16px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.5rem;
      border-bottom: 1px solid var(--brandia-border);
    }

    .modal-title {
      font-weight: 600;
      font-size: 1.25rem;
    }

    .modal-close {
      width: 32px;
      height: 32px;
      background: var(--brandia-dark);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      color: var(--brandia-text-muted);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .modal-close:hover {
      background: var(--brandia-danger);
      border-color: var(--brandia-danger);
      color: white;
    }

    .modal-body {
      padding: 1.5rem;
      overflow-y: auto;
      flex: 1;
    }

    .form-group {
      margin-bottom: 1.25rem;
    }

    .form-label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: var(--brandia-text);
    }

    .form-input,
    .form-select,
    .form-textarea {
      width: 100%;
      background: var(--brandia-dark);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      padding: 0.75rem 1rem;
      color: var(--brandia-text);
      font-size: 0.875rem;
      outline: none;
      transition: border-color 0.2s;
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
      border-color: var(--brandia-primary);
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--brandia-border);
      background: var(--brandia-darker);
    }

    /* ========== TABS ========== */
    .tabs {
      display: flex;
      gap: 0.5rem;
      padding: 0 1.5rem;
      border-bottom: 1px solid var(--brandia-border);
    }

    .tab {
      padding: 1rem 1.25rem;
      color: var(--brandia-text-muted);
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      background: none;
      border-top: none;
      border-left: none;
      border-right: none;
    }

    .tab:hover {
      color: var(--brandia-text);
    }

    .tab.active {
      color: var(--brandia-primary);
      border-bottom-color: var(--brandia-primary);
    }

    .tab-content {
      display: none;
      padding: 1.5rem;
    }

    .tab-content.active {
      display: block;
    }

    /* ========== CAMPAIGNS ========== */
    .campaign-card {
      background: var(--brandia-dark);
      border: 1px solid var(--brandia-border);
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 1rem;
    }

    .campaign-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .campaign-title {
      font-weight: 600;
      font-size: 1rem;
    }

    .campaign-status {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .campaign-status.active {
      background: rgba(16, 185, 129, 0.1);
      color: var(--brandia-success);
    }

    .campaign-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--brandia-border);
    }

    .campaign-stat {
      text-align: center;
    }

    .campaign-stat-value {
      font-weight: 700;
      font-size: 1.125rem;
      color: var(--brandia-text);
    }

    .campaign-stat-label {
      font-size: 0.75rem;
      color: var(--brandia-text-muted);
    }

    /* ========== IMPORT CSV ========== */
    .import-zone {
      border: 2px dashed var(--brandia-border);
      border-radius: 12px;
      padding: 3rem;
      text-align: center;
      transition: all 0.2s;
      cursor: pointer;
    }

    .import-zone:hover {
      border-color: var(--brandia-primary);
      background: rgba(99, 102, 241, 0.05);
    }

    .import-zone i {
      font-size: 3rem;
      color: var(--brandia-primary);
      margin-bottom: 1rem;
    }

    .import-zone h4 {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .import-zone p {
      color: var(--brandia-text-muted);
      font-size: 0.875rem;
    }

    /* ========== TOAST ========== */
    .toast-container {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .toast {
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-left: 4px solid var(--brandia-primary);
      border-radius: 12px;
      padding: 1rem 1.5rem;
      color: var(--brandia-text);
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5);
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .toast.success {
      border-left-color: var(--brandia-success);
    }

    .toast.error {
      border-left-color: var(--brandia-danger);
    }

    /* ========== MOBILE RESPONSIVE ========== */
    .mobile-header {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: var(--brandia-darker);
      border-bottom: 1px solid var(--brandia-border);
      padding: 1rem;
      z-index: 99;
      align-items: center;
      justify-content: space-between;
    }

    .mobile-menu-btn {
      width: 40px;
      height: 40px;
      background: var(--brandia-card);
      border: 1px solid var(--brandia-border);
      border-radius: 8px;
      color: var(--brandia-text);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    @media (max-width: 1024px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-header {
        display: flex;
      }

      .content-area {
        margin-top: 60px;
        padding: 1rem;
      }

      .top-header {
        display: none;
      }

      .form-row {
        grid-template-columns: 1fr;
      }
    }

    /* ========== UTILITAIRES ========== */
    .hidden {
      display: none !important;
    }

    .text-success {
      color: var(--brandia-success);
    }

    .text-danger {
      color: var(--brandia-danger);
    }

    .text-warning {
      color: var(--brandia-warning);
    }

    .text-muted {
      color: var(--brandia-text-muted);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--brandia-dark);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--brandia-border);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--brandia-card-hover);
    }
  </style>
</head>
<body>

  <!-- Mobile Header -->
  <div class="mobile-header">
    <button class="mobile-menu-btn" onclick="toggleSidebar()">
      <i class="fas fa-bars"></i>
    </button>
    <span class="brandia-text" style="font-family: 'Outfit', sans-serif; font-size: 1.25rem; font-weight: 700;">Brandia</span>
    <button class="mobile-menu-btn" onclick="logout()">
      <i class="fas fa-sign-out-alt"></i>
    </button>
  </div>

  <div class="dashboard-layout">
    
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <button class="sidebar-toggle" onclick="toggleSidebarCollapse()">
        <i class="fas fa-chevron-left" id="sidebar-toggle-icon"></i>
      </button>

      <div class="sidebar-header">
        <a href="../index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">
            <i class="fas fa-shopping-bag"></i>
          </div>
          <span class="sidebar-logo-text">Brandia</span>
        </a>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Menu</div>
          <button class="nav-item active" onclick="showSection('dashboard')" data-section="dashboard">
            <i class="fas fa-chart-line"></i>
            <span class="nav-text">Tableau de bord</span>
          </button>
          <button class="nav-item" onclick="showSection('products')" data-section="products">
            <i class="fas fa-box"></i>
            <span class="nav-text">Produits</span>
          </button>
          <button class="nav-item" onclick="showSection('orders')" data-section="orders">
            <i class="fas fa-shopping-cart"></i>
            <span class="nav-text">Commandes</span>
          </button>
          <button class="nav-item" onclick="showSection('campaigns')" data-section="campaigns">
            <i class="fas fa-bullhorn"></i>
            <span class="nav-text">Campagnes</span>
          </button>
          <button class="nav-item" onclick="showSection('promotions')" data-section="promotions">
            <i class="fas fa-percent"></i>
            <span class="nav-text">Promotions</span>
          </button>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Finances</div>
          <button class="nav-item" onclick="showSection('payments')" data-section="payments">
            <i class="fas fa-wallet"></i>
            <span class="nav-text">Paiements</span>
          </button>
          <button class="nav-item" onclick="showSection('analytics')" data-section="analytics">
            <i class="fas fa-chart-bar"></i>
            <span class="nav-text">Analytics</span>
          </button>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Param√®tres</div>
          <button class="nav-item" onclick="showSection('profile')" data-section="profile">
            <i class="fas fa-user"></i>
            <span class="nav-text">Profil</span>
          </button>
          <button class="nav-item" onclick="showSection('settings')" data-section="settings">
            <i class="fas fa-cog"></i>
            <span class="nav-text">Param√®tres</span>
          </button>
        </div>
      </nav>

      <div class="sidebar-footer">
        <a href="../index.html" class="btn-back">
          <i class="fas fa-arrow-left"></i>
          <span class="nav-text">Retour boutique</span>
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      
      <!-- Top Header -->
      <header class="top-header">
        <div class="header-search">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Rechercher..." id="global-search">
        </div>

        <div class="header-actions">
          <button class="btn-icon" onclick="refreshData()">
            <i class="fas fa-sync-alt"></i>
          </button>
          <button class="btn-icon" onclick="showNotifications()">
            <i class="fas fa-bell"></i>
            <span class="notification-badge">3</span>
          </button>
          <div class="user-menu" onclick="toggleUserMenu()">
            <div class="user-avatar" id="user-avatar">F</div>
            <div class="user-info">
              <span class="user-name" id="header-user-name">Fournisseur</span>
              <span class="user-role">Vendeur</span>
            </div>
            <i class="fas fa-chevron-down" style="color: var(--brandia-text-muted);"></i>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content-area">
        
        <!-- SECTION: DASHBOARD -->
        <section id="section-dashboard" class="section-content active">
          <div class="page-header">
            <h1 class="page-title">Tableau de bord</h1>
            <p class="page-subtitle">Vue d'ensemble de votre activit√©</p>
          </div>

          <!-- KPI Cards -->
          <div class="kpi-grid">
            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon blue">
                  <i class="fas fa-euro-sign"></i>
                </div>
                <span class="kpi-trend up">
                  <i class="fas fa-arrow-up"></i> 12.5%
                </span>
              </div>
              <div class="kpi-value" id="kpi-revenue">0 ‚Ç¨</div>
              <div class="kpi-label">Chiffre d'affaires (30j)</div>
            </div>

            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon green">
                  <i class="fas fa-shopping-bag"></i>
                </div>
                <span class="kpi-trend up">
                  <i class="fas fa-arrow-up"></i> 8.2%
                </span>
              </div>
              <div class="kpi-value" id="kpi-orders">0</div>
              <div class="kpi-label">Commandes</div>
            </div>

            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon orange">
                  <i class="fas fa-eye"></i>
                </div>
                <span class="kpi-trend down">
                  <i class="fas fa-arrow-down"></i> 3.1%
                </span>
              </div>
              <div class="kpi-value" id="kpi-views">0</div>
              <div class="kpi-label">Vues produits</div>
            </div>

            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon purple">
                  <i class="fas fa-box"></i>
                </div>
                <span class="kpi-trend up">
                  <i class="fas fa-arrow-up"></i> 5.4%
                </span>
              </div>
              <div class="kpi-value" id="kpi-products">0</div>
              <div class="kpi-label">Produits actifs</div>
            </div>
          </div>

          <!-- Charts -->
          <div class="charts-grid">
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">√âvolution des ventes</h3>
                <div class="chart-actions">
                  <button class="btn-sm active">7j</button>
                  <button class="btn-sm">30j</button>
                  <button class="btn-sm">90j</button>
                </div>
              </div>
              <div class="chart-container">
                <canvas id="salesChart"></canvas>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">R√©partition des ventes</h3>
              </div>
              <div class="chart-container">
                <canvas id="categoryChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Recent Orders -->
          <div class="section-card">
            <div class="section-header">
              <h3 class="section-title">Commandes r√©centes</h3>
              <button class="btn-secondary" onclick="showSection('orders')">
                Voir tout <i class="fas fa-arrow-right" style="margin-left: 0.5rem;"></i>
              </button>
            </div>
            <div class="section-content">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Commande</th>
                    <th>Client</th>
                    <th>Produits</th>
                    <th>Total</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="recent-orders-table">
                  <tr>
                    <td colspan="6" style="text-align: center; color: var(--brandia-text-muted); padding: 2rem;">
                      Chargement...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- SECTION: PRODUCTS -->
        <section id="section-products" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Mes produits</h1>
            <p class="page-subtitle">G√©rez votre catalogue</p>
          </div>

          <div class="section-card">
            <div class="section-header">
              <div style="display: flex; gap: 1rem;">
                <button class="btn-primary" onclick="openProductModal()">
                  <i class="fas fa-plus"></i> Nouveau produit
                </button>
                <button class="btn-secondary" onclick="openImportModal()">
                  <i class="fas fa-file-import"></i> Importer CSV
                </button>
              </div>
              <div style="display: flex; gap: 0.5rem;">
                <input type="text" placeholder="Rechercher un produit..." class="form-input" style="width: 250px;" id="product-search">
                <select class="form-select" style="width: 150px;" id="product-filter">
                  <option value="all">Tous</option>
                  <option value="active">Actifs</option>
                  <option value="inactive">Inactifs</option>
                </select>
              </div>
            </div>
            <div class="section-content">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Produit</th>
                    <th>Prix</th>
                    <th>Stock</th>
                    <th>Statut</th>
                    <th>Ventes</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="products-table">
                  <tr>
                    <td colspan="6" style="text-align: center; color: var(--brandia-text-muted); padding: 2rem;">
                      Chargement des produits...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- SECTION: ORDERS -->
        <section id="section-orders" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Commandes</h1>
            <p class="page-subtitle">Suivez et g√©rez vos commandes</p>
          </div>

          <div class="section-card">
            <div class="tabs">
              <button class="tab active" onclick="switchTab('orders-all')">Toutes</button>
              <button class="tab" onclick="switchTab('orders-pending')">En attente</button>
              <button class="tab" onclick="switchTab('orders-processing')">En cours</button>
              <button class="tab" onclick="switchTab('orders-shipped')">Exp√©di√©es</button>
              <button class="tab" onclick="switchTab('orders-delivered')">Livr√©es</button>
            </div>
            
            <div id="orders-all" class="tab-content active">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>N¬∞ Commande</th>
                    <th>Date</th>
                    <th>Client</th>
                    <th>Produits</th>
                    <th>Total</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="orders-table-all">
                  <tr>
                    <td colspan="7" style="text-align: center; color: var(--brandia-text-muted); padding: 2rem;">
                      Chargement des commandes...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- SECTION: CAMPAIGNS -->
        <section id="section-campaigns" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Campagnes publicitaires</h1>
            <p class="page-subtitle">Promouvez vos produits sur Brandia</p>
          </div>

          <div class="section-card">
            <div class="section-header">
              <button class="btn-primary" onclick="openCampaignModal()">
                <i class="fas fa-plus"></i> Nouvelle campagne
              </button>
            </div>
            <div class="section-content">
              <div id="campaigns-list">
                <div class="campaign-card">
                  <div class="campaign-header">
                    <div>
                      <h4 class="campaign-title">Soldes d'hiver 2026</h4>
                      <p class="text-muted" style="font-size: 0.875rem;">Du 01/01/2026 au 31/01/2026</p>
                    </div>
                    <span class="campaign-status active">Active</span>
                  </div>
                  <p style="color: var(--brandia-text-muted); font-size: 0.875rem; margin-bottom: 1rem;">
                    Promotion de -20% sur toute la collection hiver
                  </p>
                  <div class="campaign-stats">
                    <div class="campaign-stat">
                      <div class="campaign-stat-value">1,234</div>
                      <div class="campaign-stat-label">Impressions</div>
                    </div>
                    <div class="campaign-stat">
                      <div class="campaign-stat-value">89</div>
                      <div class="campaign-stat-label">Clics</div>
                    </div>
                    <div class="campaign-stat">
                      <div class="campaign-stat-value">12</div>
                      <div class="campaign-stat-label">Conversions</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- SECTION: PROMOTIONS -->
        <section id="section-promotions" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Promotions</h1>
            <p class="page-subtitle">Cr√©ez des offres sp√©ciales</p>
          </div>

          <div class="section-card">
            <div class="section-header">
              <button class="btn-primary" onclick="openPromotionModal()">
                <i class="fas fa-plus"></i> Nouvelle promotion
              </button>
            </div>
            <div class="section-content">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Type</th>
                    <th>Valeur</th>
                    <th>P√©riode</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="promotions-table">
                  <tr>
                    <td colspan="6" style="text-align: center; color: var(--brandia-text-muted); padding: 2rem;">
                      Aucune promotion active
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- SECTION: PAYMENTS -->
        <section id="section-payments" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Paiements</h1>
            <p class="page-subtitle">Suivez vos revenus et demandes de virement</p>
          </div>

          <div class="kpi-grid" style="grid-template-columns: repeat(3, 1fr);">
            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon green">
                  <i class="fas fa-wallet"></i>
                </div>
              </div>
              <div class="kpi-value" id="payment-balance">0 ‚Ç¨</div>
              <div class="kpi-label">Solde disponible</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon blue">
                  <i class="fas fa-clock"></i>
                </div>
              </div>
              <div class="kpi-value" id="payment-pending">0 ‚Ç¨</div>
              <div class="kpi-label">En attente</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-header">
                <div class="kpi-icon purple">
                  <i class="fas fa-check-circle"></i>
                </div>
              </div>
              <div class="kpi-value" id="payment-total">0 ‚Ç¨</div>
              <div class="kpi-label">Total encaiss√©</div>
            </div>
          </div>

          <div class="section-card">
            <div class="section-header">
              <h3 class="section-title">Historique des transactions</h3>
              <button class="btn-primary" onclick="requestPayout()">
                <i class="fas fa-money-bill-wave"></i> Demander un virement
              </button>
            </div>
            <div class="section-content">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Montant</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody id="payments-table">
                  <tr>
                    <td colspan="4" style="text-align: center; color: var(--brandia-text-muted); padding: 2rem;">
                      Aucune transaction
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- SECTION: ANALYTICS -->
        <section id="section-analytics" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Analytics</h1>
            <p class="page-subtitle">Analysez vos performances</p>
          </div>
          
          <div class="section-card">
            <div class="section-content" style="text-align: center; padding: 4rem;">
              <i class="fas fa-chart-pie" style="font-size: 4rem; color: var(--brandia-border); margin-bottom: 1rem;"></i>
              <h3 style="margin-bottom: 0.5rem;">Analytics avanc√©s</h3>
              <p style="color: var(--brandia-text-muted);">Cette fonctionnalit√© sera disponible prochainement.</p>
            </div>
          </div>
        </section>

        <!-- SECTION: PROFILE -->
        <section id="section-profile" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Mon profil</h1>
            <p class="page-subtitle">G√©rez vos informations</p>
          </div>

          <div class="section-card">
            <div class="section-content">
              <form id="profile-form" onsubmit="saveProfile(event)">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label">Nom de l'entreprise</label>
                    <input type="text" class="form-input" id="profile-company" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="profile-email" required>
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">Description</label>
                  <textarea class="form-textarea" id="profile-description"></textarea>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label">Site web</label>
                    <input type="url" class="form-input" id="profile-website">
                  </div>
                  <div class="form-group">
                    <label class="form-label">T√©l√©phone</label>
                    <input type="tel" class="form-input" id="profile-phone">
                  </div>
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 0.75rem; margin-top: 1.5rem;">
                  <button type="button" class="btn-secondary" onclick="loadProfile()">Annuler</button>
                  <button type="submit" class="btn-primary">Enregistrer</button>
                </div>
              </form>
            </div>
          </div>
        </section>

        <!-- SECTION: SETTINGS -->
        <section id="section-settings" class="section-content hidden">
          <div class="page-header">
            <h1 class="page-title">Param√®tres</h1>
            <p class="page-subtitle">Configurez votre compte</p>
          </div>

          <div class="section-card">
            <div class="section-content" style="text-align: center; padding: 4rem;">
              <i class="fas fa-cogs" style="font-size: 4rem; color: var(--brandia-border); margin-bottom: 1rem;"></i>
              <h3 style="margin-bottom: 0.5rem;">Param√®tres avanc√©s</h3>
              <p style="color: var(--brandia-text-muted);">Cette fonctionnalit√© sera disponible prochainement.</p>
            </div>
          </div>
        </section>

      </div>
    </main>
  </div>

  <!-- MODAL: Add/Edit Product -->
  <div class="modal-overlay" id="product-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title" id="product-modal-title">Nouveau produit</h3>
        <button class="modal-close" onclick="closeProductModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="product-form" onsubmit="saveProduct(event)">
          <input type="hidden" id="product-id">
          <div class="form-group">
            <label class="form-label">Nom du produit *</label>
            <input type="text" class="form-input" id="product-name" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Prix *</label>
              <input type="number" step="0.01" class="form-input" id="product-price" required>
            </div>
            <div class="form-group">
              <label class="form-label">Prix compar√© (optionnel)</label>
              <input type="number" step="0.01" class="form-input" id="product-compare-price">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Stock *</label>
              <input type="number" class="form-input" id="product-stock" required>
            </div>
            <div class="form-group">
              <label class="form-label">SKU</label>
              <input type="text" class="form-input" id="product-sku">
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Cat√©gorie</label>
            <select class="form-select" id="product-category">
              <option value="">S√©lectionner une cat√©gorie</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Description</label>
            <textarea class="form-textarea" id="product-description"></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">Image URL</label>
            <input type="url" class="form-input" id="product-image" placeholder="https://...">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" onclick="closeProductModal()">Annuler</button>
        <button type="button" class="btn-primary" onclick="document.getElementById('product-form').dispatchEvent(new Event('submit'))">
          <i class="fas fa-save"></i> Enregistrer
        </button>
      </div>
    </div>
  </div>

  <!-- MODAL: Import CSV -->
  <div class="modal-overlay" id="import-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Importer des produits</h3>
        <button class="modal-close" onclick="closeImportModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="import-zone" onclick="document.getElementById('csv-file').click()">
          <i class="fas fa-cloud-upload-alt"></i>
          <h4>Glissez-d√©posez votre fichier CSV</h4>
          <p>ou cliquez pour s√©lectionner un fichier</p>
          <input type="file" id="csv-file" accept=".csv" style="display: none;" onchange="handleCSVImport(event)">
        </div>
        <div style="margin-top: 1.5rem; padding: 1rem; background: var(--brandia-dark); border-radius: 8px;">
          <p style="font-size: 0.875rem; margin-bottom: 0.5rem;"><strong>Format attendu :</strong></p>
          <code style="font-size: 0.75rem; color: var(--brandia-text-muted);">
            name;price;stock;category;description
          </code>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" onclick="closeImportModal()">Annuler</button>
        <a href="#" class="btn-secondary" onclick="downloadTemplate()">
          <i class="fas fa-download"></i> Template
        </a>
      </div>
    </div>
  </div>

  <!-- MODAL: Add Campaign -->
  <div class="modal-overlay" id="campaign-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Nouvelle campagne</h3>
        <button class="modal-close" onclick="closeCampaignModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form id="campaign-form">
          <div class="form-group">
            <label class="form-label">Nom de la campagne *</label>
            <input type="text" class="form-input" id="campaign-name" required>
          </div>
          <div class="form-group">
            <label class="form-label">Type</label>
            <select class="form-select" id="campaign-type">
              <option value="overlay">Overlay (40% √©cran)</option>
              <option value="banner">Banni√®re</option>
            </select>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Date d√©but</label>
              <input type="date" class="form-input" id="campaign-start">
            </div>
            <div class="form-group">
              <label class="form-label">Date fin</label>
              <input type="date" class="form-input" id="campaign-end">
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Produits cibl√©s</label>
            <select class="form-select" id="campaign-products" multiple>
              <option value="all">Tous les produits</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" onclick="closeCampaignModal()">Annuler</button>
        <button type="button" class="btn-primary" onclick="saveCampaign()">
          <i class="fas fa-rocket"></i> Lancer la campagne
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Scripts -->
  <script src="../assets/js/api.js"></script>
  
  <script>
    // ========== CONFIGURATION ==========
    const API_BASE_URL = 'https://brandia-1.onrender.com/api';
    
    // ========== STATE ==========
    let currentUser = null;
    let supplierData = null;
    let products = [];
    let orders = [];
    let campaigns = [];
    let charts = {};

    // ========== INITIALIZATION ==========
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('[Dashboard] Initialisation...');
      
      // V√©rifier l'authentification
      if (!checkAuth()) {
        return;
      }
      
      // Charger les donn√©es
      await loadUserData();
      await loadDashboardData();
      await loadProducts();
      await loadOrders();
      
      // Initialiser les graphiques
      initCharts();
      
      // Mettre √† jour l'UI
      updateUI();
    });

    // ========== AUTHENTIFICATION ==========
    function checkAuth() {
      const token = localStorage.getItem('brandia_token');
      const user = localStorage.getItem('brandia_user');
      
      if (!token || !user) {
        window.location.href = '../login.html?redirect=supplier/dashboard.html';
        return false;
      }
      
      currentUser = JSON.parse(user);
      
      if (currentUser.role !== 'supplier') {
        showToast('Acc√®s r√©serv√© aux fournisseurs', 'error');
        setTimeout(() => {
          window.location.href = '../index.html';
        }, 2000);
        return false;
      }
      
      return true;
    }

    function logout() {
      if (window.BrandiaAPI && BrandiaAPI.Auth) {
        BrandiaAPI.Auth.logout();
      } else {
        localStorage.removeItem('brandia_token');
        localStorage.removeItem('brandia_user');
        window.location.href = '../login.html';
      }
    }

    // ========== DATA LOADING ==========
    async function loadUserData() {
      try {
        const response = await fetch(`${API_BASE_URL}/supplier/profile`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          }
        });
        
        if (response.ok) {
          const data = await response.json();
          supplierData = data.data;
          updateUserInfo();
        }
      } catch (error) {
        console.error('[Dashboard] Erreur chargement profil:', error);
      }
    }

    async function loadDashboardData() {
      try {
        // Charger les statistiques
        const statsResponse = await fetch(`${API_BASE_URL}/supplier/stats`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          }
        });
        
        if (statsResponse.ok) {
          const stats = await statsResponse.json();
          updateKPIs(stats.data);
        }
      } catch (error) {
        console.error('[Dashboard] Erreur chargement stats:', error);
        // Donn√©es de d√©mo
        updateKPIs({
          revenue: 12580.50,
          orders: 48,
          views: 3254,
          products: 12
        });
      }
    }

    async function loadProducts() {
      try {
        const response = await fetch(`${API_BASE_URL}/supplier/products`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          }
        });
        
        if (response.ok) {
          const data = await response.json();
          products = data.data || [];
          renderProductsTable();
        }
      } catch (error) {
        console.error('[Dashboard] Erreur chargement produits:', error);
        products = [];
        renderProductsTable();
      }
    }

    async function loadOrders() {
      try {
        const response = await fetch(`${API_BASE_URL}/supplier/orders`, {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          }
        });
        
        if (response.ok) {
          const data = await response.json();
          orders = data.data || [];
          renderOrdersTable();
          renderRecentOrders();
        }
      } catch (error) {
        console.error('[Dashboard] Erreur chargement commandes:', error);
        orders = [];
        renderOrdersTable();
        renderRecentOrders();
      }
    }

    // ========== UI UPDATES ==========
    function updateUI() {
      updateUserInfo();
    }

    function updateUserInfo() {
      const userName = document.getElementById('header-user-name');
      const userAvatar = document.getElementById('user-avatar');
      
      if (userName && currentUser) {
        userName.textContent = currentUser.first_name || currentUser.company_name || 'Fournisseur';
      }
      
      if (userAvatar && currentUser) {
        const initial = (currentUser.first_name || currentUser.company_name || 'F').charAt(0).toUpperCase();
        userAvatar.textContent = initial;
      }
    }

    function updateKPIs(stats) {
      document.getElementById('kpi-revenue').textContent = formatCurrency(stats.revenue);
      document.getElementById('kpi-orders').textContent = stats.orders;
      document.getElementById('kpi-views').textContent = stats.views.toLocaleString();
      document.getElementById('kpi-products').textContent = stats.products;
    }

    // ========== NAVIGATION ==========
    function showSection(sectionName) {
      // Cacher toutes les sections
      document.querySelectorAll('.section-content').forEach(section => {
        section.classList.add('hidden');
        section.classList.remove('active');
      });
      
      // Afficher la section demand√©e
      const targetSection = document.getElementById(`section-${sectionName}`);
      if (targetSection) {
        targetSection.classList.remove('hidden');
        targetSection.classList.add('active');
      }
      
      // Mettre √† jour la navigation
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.section === sectionName) {
          item.classList.add('active');
        }
      });
      
      // Fermer le sidebar sur mobile
      if (window.innerWidth <= 1024) {
        document.getElementById('sidebar').classList.remove('open');
      }
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
    }

    function toggleSidebarCollapse() {
      const sidebar = document.getElementById('sidebar');
      const icon = document.getElementById('sidebar-toggle-icon');
      
      sidebar.classList.toggle('collapsed');
      
      if (sidebar.classList.contains('collapsed')) {
        icon.classList.remove('fa-chevron-left');
        icon.classList.add('fa-chevron-right');
      } else {
        icon.classList.remove('fa-chevron-right');
        icon.classList.add('fa-chevron-left');
      }
    }

    function switchTab(tabId) {
      // Mettre √† jour les onglets
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Afficher le contenu
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById(tabId).classList.add('active');
    }

    // ========== PRODUCTS ==========
    function renderProductsTable() {
      const tbody = document.getElementById('products-table');
      
      if (products.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: var(--brandia-text-muted); padding: 3rem;">
              <i class="fas fa-box-open" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
              Aucun produit. Commencez par en ajouter un !
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = products.map(product => `
        <tr>
          <td>
            <div class="product-cell">
              <img src="${product.main_image_url || 'https://via.placeholder.com/48'}" alt="${product.name}" class="product-thumb">
              <div class="product-info">
                <span class="product-name">${product.name}</span>
                <span class="product-sku">${product.sku || 'Sans SKU'}</span>
              </div>
            </div>
          </td>
          <td>
            <div style="display: flex; flex-direction: column;">
              <span style="font-weight: 600;">${formatCurrency(product.price)}</span>
              ${product.compare_price ? `<span style="text-decoration: line-through; color: var(--brandia-text-muted); font-size: 0.75rem;">${formatCurrency(product.compare_price)}</span>` : ''}
            </div>
          </td>
          <td>${product.stock_quantity}</td>
          <td>
            <span class="status-badge ${product.is_active ? 'active' : 'inactive'}">
              <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
              ${product.is_active ? 'Actif' : 'Inactif'}
            </span>
          </td>
          <td>${product.sales_count || 0}</td>
          <td>
            <div class="table-actions">
              <button class="btn-table" onclick="editProduct(${product.id})" title="Modifier">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-table" onclick="toggleProductStatus(${product.id})" title="${product.is_active ? 'D√©sactiver' : 'Activer'}">
                <i class="fas fa-${product.is_active ? 'eye-slash' : 'eye'}"></i>
              </button>
              <button class="btn-table" onclick="deleteProduct(${product.id})" title="Supprimer" style="color: var(--brandia-danger);">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `).join('');
    }

    function openProductModal(productId = null) {
      const modal = document.getElementById('product-modal');
      const title = document.getElementById('product-modal-title');
      
      if (productId) {
        const product = products.find(p => p.id === productId);
        if (product) {
          title.textContent = 'Modifier le produit';
          document.getElementById('product-id').value = product.id;
          document.getElementById('product-name').value = product.name;
          document.getElementById('product-price').value = product.price;
          document.getElementById('product-compare-price').value = product.compare_price || '';
          document.getElementById('product-stock').value = product.stock_quantity;
          document.getElementById('product-sku').value = product.sku || '';
          document.getElementById('product-description').value = product.description || '';
          document.getElementById('product-image').value = product.main_image_url || '';
        }
      } else {
        title.textContent = 'Nouveau produit';
        document.getElementById('product-form').reset();
        document.getElementById('product-id').value = '';
      }
      
      modal.classList.add('active');
    }

    function closeProductModal() {
      document.getElementById('product-modal').classList.remove('active');
    }

    async function saveProduct(event) {
      event.preventDefault();
      
      const productId = document.getElementById('product-id').value;
      const productData = {
        name: document.getElementById('product-name').value,
        price: parseFloat(document.getElementById('product-price').value),
        compare_price: parseFloat(document.getElementById('product-compare-price').value) || null,
        stock_quantity: parseInt(document.getElementById('product-stock').value),
        sku: document.getElementById('product-sku').value,
        description: document.getElementById('product-description').value,
        main_image_url: document.getElementById('product-image').value,
        category_id: document.getElementById('product-category').value || null
      };
      
      try {
        const url = productId 
          ? `${API_BASE_URL}/supplier/products/${productId}`
          : `${API_BASE_URL}/supplier/products`;
        
        const method = productId ? 'PUT' : 'POST';
        
        const response = await fetch(url, {
          method,
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          },
          body: JSON.stringify(productData)
        });
        
        if (response.ok) {
          showToast(productId ? 'Produit mis √† jour' : 'Produit cr√©√©', 'success');
          closeProductModal();
          await loadProducts();
        } else {
          const error = await response.json();
          showToast(error.message || 'Erreur lors de l\'enregistrement', 'error');
        }
      } catch (error) {
        console.error('[Dashboard] Erreur sauvegarde produit:', error);
        showToast('Erreur de connexion', 'error');
      }
    }

    async function toggleProductStatus(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      
      try {
        const response = await fetch(`${API_BASE_URL}/supplier/products/${productId}/toggle`, {
          method: 'PATCH',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          }
        });
        
        if (response.ok) {
          showToast(`Produit ${product.is_active ? 'd√©sactiv√©' : 'activ√©'}`, 'success');
          await loadProducts();
        }
      } catch (error) {
        console.error('[Dashboard] Erreur toggle statut:', error);
        showToast('Erreur lors du changement de statut', 'error');
      }
    }

    async function deleteProduct(productId) {
      if (!confirm('√ätes-vous s√ªr de vouloir supprimer ce produit ?')) {
        return;
      }
      
      try {
        const response = await fetch(`${API_BASE_URL}/supplier/products/${productId}`, {
          method: 'DELETE',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          }
        });
        
        if (response.ok) {
          showToast('Produit supprim√©', 'success');
          await loadProducts();
        }
      } catch (error) {
        console.error('[Dashboard] Erreur suppression produit:', error);
        showToast('Erreur lors de la suppression', 'error');
      }
    }

    // ========== ORDERS ==========
    function renderOrdersTable() {
      const tbody = document.getElementById('orders-table-all');
      
      if (orders.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; color: var(--brandia-text-muted); padding: 3rem;">
              <i class="fas fa-shopping-bag" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
              Aucune commande pour le moment
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = orders.map(order => `
        <tr>
          <td><strong>#${order.order_number}</strong></td>
          <td>${new Date(order.created_at).toLocaleDateString('fr-FR')}</td>
          <td>${order.customer_name || order.customer_email}</td>
          <td>${order.items_count} article(s)</td>
          <td>${formatCurrency(order.total)}</td>
          <td>
            <span class="status-badge ${getOrderStatusClass(order.status)}">
              <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
              ${getOrderStatusLabel(order.status)}
            </span>
          </td>
          <td>
            <div class="table-actions">
              <button class="btn-table" onclick="viewOrder(${order.id})" title="Voir d√©tails">
                <i class="fas fa-eye"></i>
              </button>
              ${order.status === 'pending' ? `
                <button class="btn-table" onclick="updateOrderStatus(${order.id}, 'processing')" title="Accepter">
                  <i class="fas fa-check"></i>
                </button>
              ` : ''}
            </div>
          </td>
        </tr>
      `).join('');
    }

    function renderRecentOrders() {
      const tbody = document.getElementById('recent-orders-table');
      const recentOrders = orders.slice(0, 5);
      
      if (recentOrders.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: var(--brandia-text-muted); padding: 2rem;">
              Aucune commande r√©cente
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = recentOrders.map(order => `
        <tr>
          <td><strong>#${order.order_number}</strong></td>
          <td>${order.customer_name || order.customer_email}</td>
          <td>${order.items_count} article(s)</td>
          <td>${formatCurrency(order.total)}</td>
          <td>
            <span class="status-badge ${getOrderStatusClass(order.status)}">
              <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
              ${getOrderStatusLabel(order.status)}
            </span>
          </td>
          <td>
            <button class="btn-table" onclick="viewOrder(${order.id})">
              <i class="fas fa-eye"></i>
            </button>
          </td>
        </tr>
      `).join('');
    }

    function getOrderStatusClass(status) {
      const classes = {
        'pending': 'pending',
        'processing': 'active',
        'shipped': 'active',
        'delivered': 'active',
        'cancelled': 'inactive'
      };
      return classes[status] || 'pending';
    }

    function getOrderStatusLabel(status) {
      const labels = {
        'pending': 'En attente',
        'processing': 'En cours',
        'shipped': 'Exp√©di√©e',
        'delivered': 'Livr√©e',
        'cancelled': 'Annul√©e'
      };
      return labels[status] || status;
    }

    // ========== IMPORT CSV ==========
    function openImportModal() {
      document.getElementById('import-modal').classList.add('active');
    }

    function closeImportModal() {
      document.getElementById('import-modal').classList.remove('active');
    }

    async function handleCSVImport(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      
      reader.onload = async (e) => {
        const csv = e.target.result;
        const lines = csv.split('\n');
        const headers = lines[0].split(';').map(h => h.trim());
        
        const products = [];
        
        for (let i = 1; i < lines.length; i++) {
          if (!lines[i].trim()) continue;
          
          const values = lines[i].split(';');
          const product = {};
          
          headers.forEach((header, index) => {
            product[header] = values[index]?.trim();
          });
          
          products.push(product);
        }
        
        try {
          const response = await fetch(`${API_BASE_URL}/supplier/products/import`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
            },
            body: JSON.stringify({ products })
          });
          
          if (response.ok) {
            const result = await response.json();
            showToast(`${result.imported} produits import√©s`, 'success');
            closeImportModal();
            await loadProducts();
          } else {
            showToast('Erreur lors de l\'import', 'error');
          }
        } catch (error) {
          console.error('[Dashboard] Erreur import CSV:', error);
          showToast('Erreur de connexion', 'error');
        }
      };
      
      reader.readAsText(file);
    }

    function downloadTemplate() {
      const csv = 'name;price;stock;category;description\nProduit exemple;29.99;10;√âlectronique;Description du produit';
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'template_produits.csv';
      a.click();
    }

    // ========== CAMPAIGNS ==========
    function openCampaignModal() {
      document.getElementById('campaign-modal').classList.add('active');
      // Charger les produits dans le select
      const select = document.getElementById('campaign-products');
      select.innerHTML = '<option value="all">Tous les produits</option>' +
        products.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
    }

    function closeCampaignModal() {
      document.getElementById('campaign-modal').classList.remove('active');
    }

    async function saveCampaign() {
      const campaignData = {
        name: document.getElementById('campaign-name').value,
        type: document.getElementById('campaign-type').value,
        start_date: document.getElementById('campaign-start').value,
        end_date: document.getElementById('campaign-end').value,
        product_ids: Array.from(document.getElementById('campaign-products').selectedOptions).map(o => o.value)
      };
      
      try {
        const response = await fetch(`${API_BASE_URL}/supplier/campaigns`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('brandia_token')}`
          },
          body: JSON.stringify(campaignData)
        });
        
        if (response.ok) {
          showToast('Campagne cr√©√©e avec succ√®s', 'success');
          closeCampaignModal();
        } else {
          showToast('Erreur lors de la cr√©ation', 'error');
        }
      } catch (error) {
        console.error('[Dashboard] Erreur cr√©ation campagne:', error);
        showToast('Erreur de connexion', 'error');
      }
    }

    // ========== CHARTS ==========
    function initCharts() {
      // Graphique des ventes
      const salesCtx = document.getElementById('salesChart').getContext('2d');
      charts.sales = new Chart(salesCtx, {
        type: 'line',
        data: {
          labels: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
          datasets: [{
            label: 'Ventes (‚Ç¨)',
            data: [1200, 1900, 1500, 2200, 1800, 2800, 2400],
            borderColor: '#6366f1',
            backgroundColor: 'rgba(99, 102, 241, 0.1)',
            tension: 0.4,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              grid: {
                color: 'rgba(51, 65, 85, 0.5)'
              },
              ticks: {
                color: '#94a3b8'
              }
            },
            x: {
              grid: {
                display: false
              },
              ticks: {
                color: '#94a3b8'
              }
            }
          }
        }
      });
      
      // Graphique des cat√©gories
      const categoryCtx = document.getElementById('categoryChart').getContext('2d');
      charts.category = new Chart(categoryCtx, {
        type: 'doughnut',
        data: {
          labels: ['√âlectronique', 'Mode', 'Maison', 'Sport'],
          datasets: [{
            data: [35, 25, 20, 20],
            backgroundColor: ['#6366f1', '#8b5cf6', '#ec4899', '#10b981']
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                color: '#94a3b8',
                padding: 20
              }
            }
          }
        }
      });
    }

    // ========== UTILITAIRES ==========
    function formatCurrency(amount) {
      return new Intl.NumberFormat('fr-FR', {
        style: 'currency',
        currency: 'EUR'
      }).format(amount || 0);
    }

    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `
        <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
        <span>${message}</span>
      `;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function refreshData() {
      showToast('Actualisation des donn√©es...', 'success');
      loadDashboardData();
      loadProducts();
      loadOrders();
    }

    function showNotifications() {
      showToast('3 nouvelles notifications', 'info');
    }

    function toggleUserMenu() {
      // Menu utilisateur dropdown
      showToast('Menu utilisateur', 'info');
    }

    // Fermer les modals en cliquant √† l'ext√©rieur
    document.querySelectorAll('.modal-overlay').forEach(overlay => {
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) {
          overlay.classList.remove('active');
        }
      });
    });
  </script>

</body>
</html>